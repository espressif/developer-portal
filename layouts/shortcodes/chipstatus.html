{{ $uniqueID := .Get "jsonKey" | urlize }} <!-- Generate a unique ID -->
<div id="content-{{ $uniqueID }}">Loading...</div>

{{ $contentPath := .Get "contentPath" }}
{{ $jsonKey := .Get "jsonKey" }}
{{ $fullURL := printf "%s%s" .Site.BaseURL $contentPath }}

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const url = '{{ $fullURL }}';
    const jsonKey = '{{ $jsonKey }}';
    const uniqueID = '{{ $uniqueID }}';

    fetch(url) // Fetch the JSON file
      .then(response => {
        if (!response.ok) {
          throw new Error('Error fetching the JSON data');
        }
        return response.json();
      })
      .then(data => {
        if (!data[jsonKey]) {
          throw new Error(`Key "${jsonKey}" not found in the JSON data`);
        }

        let content;
        if (jsonKey === "generated_time") {
          // Convert ISO8601 time to local time
          const isoTime = data[jsonKey];
          const localTime = new Date(isoTime).toLocaleString(); // Convert to local time
          content = `<p>Generated Time: ${localTime}</p>`;
        } else {
          // Extract the value for the key and convert the markdown to HTML
          let markdown = data[jsonKey];
          content = marked.parse(markdown);
        }

        // Inject the content into the unique content div
        document.getElementById(`content-${uniqueID}`).innerHTML = content;
      })
      .catch(error => {
        document.getElementById(`content-${uniqueID}`).textContent = 'Error loading content: ' + error.message;
      });
  });
</script>
